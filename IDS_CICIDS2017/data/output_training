X:\miniconda3\envs\ids\python.exe X:\PycharmProjects\PythonProject\src\main.py
GPUs detectadas: [PhysicalDevice(name='/physical_device:GPU:0', device_type='GPU')]
GPU configurada correctamente
Archivos encontrados: 8
Cargando ../data/MachineLearningCVE\Friday-WorkingHours-Afternoon-DDos.pcap_ISCX.csv
Cargando ../data/MachineLearningCVE\Friday-WorkingHours-Afternoon-PortScan.pcap_ISCX.csv
Cargando ../data/MachineLearningCVE\Friday-WorkingHours-Morning.pcap_ISCX.csv
Cargando ../data/MachineLearningCVE\Monday-WorkingHours.pcap_ISCX.csv
Cargando ../data/MachineLearningCVE\Thursday-WorkingHours-Afternoon-Infilteration.pcap_ISCX.csv
Cargando ../data/MachineLearningCVE\Thursday-WorkingHours-Morning-WebAttacks.pcap_ISCX.csv
Cargando ../data/MachineLearningCVE\Tuesday-WorkingHours.pcap_ISCX.csv
Cargando ../data/MachineLearningCVE\Wednesday-workingHours.pcap_ISCX.csv
Dataset combinado: (2830743, 79)
Train shape: (2264594, 78) Test shape: (566149, 78)
Class weights: {0: 0.08302162204252612, 1: 95.98992878942015, 2: 1.4740343833722573, 3: 18.334421451471876, 4: 0.8166951569417457, 5: 34.318276050190946, 6: 32.559730848861285, 7: 23.77377173091459, 8: 17156.01818181818, 9: 5242.116666666667, 10: 1.1874171018687472, 11: 32.00206884856707, 12: 125.2264100862641, 13: 8986.485714285714, 14: 289.4420245398773}
2025-09-16 11:56:52.953159: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-09-16 11:56:54.637789: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1616] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 4609 MB memory:  -> device: 0, name: NVIDIA GeForce GTX 1060 6GB, pci bus id: 0000:01:00.0, compute capability: 6.1
Model: "sequential"
_________________________________________________________________
 Layer (type)                Output Shape              Param #
=================================================================
 dense (Dense)               (None, 512)               40448

 batch_normalization (BatchN  (None, 512)              2048
 ormalization)

 dropout (Dropout)           (None, 512)               0

 dense_1 (Dense)             (None, 256)               131328

 batch_normalization_1 (Batc  (None, 256)              1024
 hNormalization)

 dropout_1 (Dropout)         (None, 256)               0

 dense_2 (Dense)             (None, 128)               32896

 batch_normalization_2 (Batc  (None, 128)              512
 hNormalization)

 dropout_2 (Dropout)         (None, 128)               0

 dense_3 (Dense)             (None, 15)                1935

=================================================================
Total params: 210,191
Trainable params: 208,399
Non-trainable params: 1,792
_________________________________________________________________
2025-09-16 11:56:55.138744: W tensorflow/core/framework/cpu_allocator_impl.cc:82] Allocation of 635897808 exceeds 10% of free system memory.
Epoch 1/100
31846/31846 [==============================] - 276s 9ms/step - loss: 1.3431 - accuracy: 0.6201 - val_loss: 1.5996 - val_accuracy: 0.6308 - lr: 0.0010
Epoch 2/100
31846/31846 [==============================] - 273s 9ms/step - loss: 1.0380 - accuracy: 0.6822 - val_loss: 1.0074 - val_accuracy: 0.7216 - lr: 0.0010
Epoch 3/100
31846/31846 [==============================] - 269s 8ms/step - loss: 0.7962 - accuracy: 0.7320 - val_loss: 0.6282 - val_accuracy: 0.7829 - lr: 0.0010
Epoch 4/100
31846/31846 [==============================] - 268s 8ms/step - loss: 0.8982 - accuracy: 0.7568 - val_loss: 1.0140 - val_accuracy: 0.7057 - lr: 0.0010
Epoch 5/100
31846/31846 [==============================] - 272s 9ms/step - loss: 0.7453 - accuracy: 0.7690 - val_loss: 0.5244 - val_accuracy: 0.8175 - lr: 0.0010
Epoch 6/100
31846/31846 [==============================] - 269s 8ms/step - loss: 0.8253 - accuracy: 0.7961 - val_loss: 0.7898 - val_accuracy: 0.7622 - lr: 0.0010
Epoch 7/100
31846/31846 [==============================] - 269s 8ms/step - loss: 0.7274 - accuracy: 0.7976 - val_loss: 0.7201 - val_accuracy: 0.7964 - lr: 0.0010
Epoch 8/100
31846/31846 [==============================] - 267s 8ms/step - loss: 0.7135 - accuracy: 0.7940 - val_loss: 0.6530 - val_accuracy: 0.7895 - lr: 0.0010
Epoch 9/100
31846/31846 [==============================] - 267s 8ms/step - loss: 0.8806 - accuracy: 0.7898 - val_loss: 0.5774 - val_accuracy: 0.8083 - lr: 0.0010
Epoch 10/100
31846/31846 [==============================] - 265s 8ms/step - loss: 0.7165 - accuracy: 0.8247 - val_loss: 0.5872 - val_accuracy: 0.8221 - lr: 5.0000e-04
Epoch 11/100
31846/31846 [==============================] - 267s 8ms/step - loss: 0.5398 - accuracy: 0.8324 - val_loss: 0.6409 - val_accuracy: 0.8178 - lr: 5.0000e-04
Epoch 12/100
31846/31846 [==============================] - 266s 8ms/step - loss: 0.7351 - accuracy: 0.8274 - val_loss: 0.4842 - val_accuracy: 0.8281 - lr: 5.0000e-04
Epoch 13/100
31846/31846 [==============================] - 271s 9ms/step - loss: 0.5415 - accuracy: 0.8398 - val_loss: 0.4770 - val_accuracy: 0.8375 - lr: 5.0000e-04
Epoch 14/100
31846/31846 [==============================] - 270s 8ms/step - loss: 0.5641 - accuracy: 0.8461 - val_loss: 0.4194 - val_accuracy: 0.8544 - lr: 5.0000e-04
Epoch 15/100
31846/31846 [==============================] - 269s 8ms/step - loss: 0.5215 - accuracy: 0.8560 - val_loss: 0.4477 - val_accuracy: 0.8573 - lr: 5.0000e-04
Epoch 16/100
31846/31846 [==============================] - 269s 8ms/step - loss: 0.6426 - accuracy: 0.8494 - val_loss: 0.4292 - val_accuracy: 0.8571 - lr: 5.0000e-04
Epoch 17/100
31846/31846 [==============================] - 270s 8ms/step - loss: 0.4725 - accuracy: 0.8579 - val_loss: 0.6282 - val_accuracy: 0.7891 - lr: 5.0000e-04
Epoch 18/100
31846/31846 [==============================] - 269s 8ms/step - loss: 0.6014 - accuracy: 0.8669 - val_loss: 0.3501 - val_accuracy: 0.8963 - lr: 5.0000e-04
Epoch 19/100
31846/31846 [==============================] - 266s 8ms/step - loss: 0.4874 - accuracy: 0.8587 - val_loss: 0.3550 - val_accuracy: 0.8908 - lr: 5.0000e-04
Epoch 20/100
31846/31846 [==============================] - 266s 8ms/step - loss: 0.4705 - accuracy: 0.8730 - val_loss: 0.3207 - val_accuracy: 0.9034 - lr: 5.0000e-04
Epoch 21/100
31846/31846 [==============================] - 266s 8ms/step - loss: 0.4712 - accuracy: 0.8751 - val_loss: 0.5133 - val_accuracy: 0.8455 - lr: 5.0000e-04
Epoch 22/100
31846/31846 [==============================] - 266s 8ms/step - loss: 0.4383 - accuracy: 0.8668 - val_loss: 0.5658 - val_accuracy: 0.8166 - lr: 5.0000e-04
Epoch 23/100
31846/31846 [==============================] - 270s 8ms/step - loss: 0.5331 - accuracy: 0.8800 - val_loss: 0.3895 - val_accuracy: 0.8565 - lr: 5.0000e-04
Epoch 24/100
31846/31846 [==============================] - 274s 9ms/step - loss: 0.4857 - accuracy: 0.8775 - val_loss: 0.3562 - val_accuracy: 0.8924 - lr: 5.0000e-04
Epoch 25/100
31846/31846 [==============================] - 270s 8ms/step - loss: 0.4371 - accuracy: 0.8889 - val_loss: 0.3728 - val_accuracy: 0.8968 - lr: 2.5000e-04
Epoch 26/100
31846/31846 [==============================] - 272s 9ms/step - loss: 0.4115 - accuracy: 0.8890 - val_loss: 0.3267 - val_accuracy: 0.8894 - lr: 2.5000e-04
Epoch 27/100
31846/31846 [==============================] - 270s 8ms/step - loss: 0.4101 - accuracy: 0.8883 - val_loss: 0.3259 - val_accuracy: 0.9071 - lr: 2.5000e-04
Epoch 28/100
31846/31846 [==============================] - 274s 9ms/step - loss: 0.3672 - accuracy: 0.8899 - val_loss: 0.2906 - val_accuracy: 0.9121 - lr: 2.5000e-04
Epoch 29/100
31846/31846 [==============================] - 266s 8ms/step - loss: 0.4356 - accuracy: 0.8970 - val_loss: 0.3028 - val_accuracy: 0.9052 - lr: 2.5000e-04
Epoch 30/100
31846/31846 [==============================] - 266s 8ms/step - loss: 0.4129 - accuracy: 0.8958 - val_loss: 0.4317 - val_accuracy: 0.8534 - lr: 2.5000e-04
Epoch 31/100
31846/31846 [==============================] - 266s 8ms/step - loss: 0.4379 - accuracy: 0.8979 - val_loss: 0.3558 - val_accuracy: 0.8831 - lr: 2.5000e-04
Epoch 32/100
31846/31846 [==============================] - 266s 8ms/step - loss: 0.3638 - accuracy: 0.8916 - val_loss: 0.2607 - val_accuracy: 0.9149 - lr: 2.5000e-04
Epoch 33/100
31846/31846 [==============================] - 266s 8ms/step - loss: 0.3889 - accuracy: 0.8975 - val_loss: 0.5367 - val_accuracy: 0.8307 - lr: 2.5000e-04
Epoch 34/100
31846/31846 [==============================] - 266s 8ms/step - loss: 0.4042 - accuracy: 0.8912 - val_loss: 0.4122 - val_accuracy: 0.8614 - lr: 2.5000e-04
Epoch 35/100
31846/31846 [==============================] - 266s 8ms/step - loss: 0.4477 - accuracy: 0.8978 - val_loss: 0.3133 - val_accuracy: 0.9058 - lr: 2.5000e-04
Epoch 36/100
31846/31846 [==============================] - 267s 8ms/step - loss: 0.3987 - accuracy: 0.8946 - val_loss: 0.3699 - val_accuracy: 0.8842 - lr: 2.5000e-04
Epoch 37/100
31846/31846 [==============================] - 266s 8ms/step - loss: 0.4342 - accuracy: 0.8956 - val_loss: 0.5604 - val_accuracy: 0.8210 - lr: 1.2500e-04
Epoch 38/100
31846/31846 [==============================] - 266s 8ms/step - loss: 0.3829 - accuracy: 0.8984 - val_loss: 0.3326 - val_accuracy: 0.8978 - lr: 1.2500e-04
Epoch 39/100
31846/31846 [==============================] - 267s 8ms/step - loss: 0.3844 - accuracy: 0.9003 - val_loss: 0.2733 - val_accuracy: 0.9157 - lr: 1.2500e-04
Epoch 40/100
31846/31846 [==============================] - 267s 8ms/step - loss: 0.4195 - accuracy: 0.8998 - val_loss: 0.2956 - val_accuracy: 0.9129 - lr: 1.2500e-04
17693/17693 [==============================] - 53s 3ms/step - loss: 0.2560 - accuracy: 0.9161
Loss: 0.2560, Accuracy: 0.9161
17693/17693 [==============================] - 36s 2ms/step

=== Classification Report ===
                            precision    recall  f1-score   support

                    BENIGN       1.00      0.90      0.95    454620
                       Bot       0.03      1.00      0.06       393
                      DDoS       0.79      1.00      0.88     25606
             DoS GoldenEye       0.77      0.96      0.85      2059
                  DoS Hulk       0.83      1.00      0.91     46215
          DoS Slowhttptest       0.58      0.99      0.73      1100
             DoS slowloris       0.74      0.99      0.84      1159
               FTP-Patator       0.47      0.99      0.63      1588
                Heartbleed       0.25      1.00      0.40         2
              Infiltration       0.01      0.57      0.02         7
                  PortScan       0.82      1.00      0.90     31786
               SSH-Patator       0.38      0.99      0.55      1179
  Web Attack � Brute Force       0.03      0.10      0.05       301
Web Attack � Sql Injection       0.00      0.25      0.00         4
          Web Attack � XSS       0.04      0.93      0.07       130

                  accuracy                           0.92    566149
                 macro avg       0.45      0.84      0.52    566149
              weighted avg       0.96      0.92      0.93    566149

Modelo y preprocesadores guardados correctamente.
Logs de TensorBoard en: logs\20250916-115654

Process finished with exit code 0